<# This program can be used to automate 100 malware detonation to a computer 
from the filelist.txt. All the downloaded malware packages will be extracted 
to the Desktop folder of the current user who run it.
---------------------------------------------------------------------------
WARNING!!! PLEASE USE IT BY YOUR UNDERSTANDING !!! #>

# Read the list of URLs from the txt file
$fileListPath = "C:\Users\$env:USERNAME\Desktop\filelist.txt"
$urlList = Get-Content -Path $fileListPath
 
# Path to 7-Zip executable
$zipExecutable = "C:\Program Files\7-Zip\7z.exe"
 
$lineCounter = 0
# Loop through each URL
foreach ($url in $urlList) {
    $lineCounter = $lineCounter + 1
    # Extract the filename from the URL
    $fileName = [System.IO.Path]::GetFileName($url)
 
    # Create a folder with the same name as the zip file (without extension)
    $folderName = [System.IO.Path]::GetFileNameWithoutExtension($fileName)
    $destinationFolder = "C:\Users\$env:USERNAME\Desktop\SAMPLE-$lineCounter"
 
    # Create the folder if it doesn't exist
    if (-not (Test-Path $destinationFolder -PathType Container)) {
        Write-Host "Step 0: Creating folder $folderName"
        New-Item -ItemType Directory -Path $destinationFolder
    }
 
    # Download the zip file
    $zipFilePath = Join-Path $destinationFolder $fileName
    Write-Host "`nStep 1: Downloading $fileName from $url"
    Invoke-WebRequest -Uri $url -OutFile $zipFilePath
 
    # Extract the contents of the zip file with 7-Zip and the specified password
    Write-Host "`nStep 2: Extracting $fileName to $destinationFolder"
    $outputdir = "-o$destinationFolder"
    & $zipExecutable x $outputdir -pinfected -aoa $zipFilePath
 
    # Clean up: Optional - Delete the zip file if you want
    Remove-Item -Path $zipFilePath
 
    Write-Host "`nStep 3: Process completed for $fileName"
    Write-Host "--------------------------------------------------------"
 
    # Add a 5-second delay
    Start-Sleep -Seconds 5
}
